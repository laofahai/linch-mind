# ğŸ¯ Linch Mind CI/CD ç»Ÿä¸€ç‰ˆæœ¬é…ç½®
# æ‰€æœ‰å·¥ä½œæµéƒ½ä»æ­¤æ–‡ä»¶è¯»å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œç¡®ä¿ä¸€è‡´æ€§

versions:
  # æ ¸å¿ƒè¿è¡Œæ—¶ç‰ˆæœ¬ (åŸºäºé¡¹ç›®å®é™…é…ç½®)
  flutter: "3.32.0"  # åŸºäºui/pubspec.yamlå®é™…ç‰ˆæœ¬
  python: "3.11"     # åŸºäºdaemon/pyproject.tomlï¼Œç»Ÿä¸€ä¸º3.11+
  dart: "3.0"        # Flutter 3.32å¯¹åº”çš„Dartç‰ˆæœ¬

  # æ„å»ºå·¥å…·ç‰ˆæœ¬
  poetry: "2.1.3"    # Latest stable Poetry version for 2025
  cmake: "3.16"      # åŸºäºconnectors/CMakeLists.txtæœ€ä½è¦æ±‚

  # ç¬¬ä¸‰æ–¹AIå·¥å…·ç‰ˆæœ¬
  ollama: "0.1.32"

  # ä¾èµ–åº“å…³é”®ç‰ˆæœ¬
  sqlalchemy: "2.0"  # åŸºäºdaemonå®é™…ä¾èµ–
  riverpod: "2.4"    # åŸºäºuiå®é™…ä¾èµ–
  faiss: "1.8"       # AIå‘é‡æœç´¢åº“

  # CI/CDå·¥å…·ç‰ˆæœ¬
  actions:
    checkout: "v5"
    setup_python: "v5"
    setup_java: "v4"
    setup_node: "v4"
    upload_artifact: "v4"
    download_artifact: "v4"
    cache: "v4"

# ç¯å¢ƒé…ç½®
environments:
  development:
    registry_url: "http://localhost:8001"
    daemon_url: "http://localhost:8000"
    database_encryption: false

  staging:
    registry_url: "https://staging-registry.linch-mind.com"
    daemon_url: "https://staging-api.linch-mind.com"
    database_encryption: true

  production:
    registry_url: "https://registry.linch-mind.com"
    daemon_url: "https://api.linch-mind.com"
    database_encryption: true

# æ„å»ºé…ç½®
build:
  # é»˜è®¤æ„å»ºå¹³å°
  platforms:
    flutter: ["linux", "macos", "windows", "android", "ios", "web"]
    connectors: ["ubuntu-latest", "windows-latest", "macos-latest"]
    installers: ["linux", "macos", "windows"]

  # è´¨é‡é—¨ç¦é…ç½®
  quality_gates:
    test_coverage_threshold: 20
    security_scan_severity: "high"
    code_style_enforcement: true
    performance_regression_threshold: 0.1  # 10% performance regression limit

  # æ„å»ºä¼˜åŒ–
  cache_strategy:
    flutter: true
    python: true
    node: true
    gradle: true
    poetry: true

  # æ‰“åŒ…é…ç½®
  packaging:
    include_ollama: true
    include_ai_models: false  # æ¨¡å‹æŒ‰éœ€ä¸‹è½½ï¼Œä¸æ‰“åŒ…
    compress_level: 9
    sign_packages: true

# å‘å¸ƒé…ç½®
release:
  # è‡ªåŠ¨å‘å¸ƒæ¡ä»¶
  auto_release:
    branches: ["main"]
    path_patterns: ["ui/**", "daemon/**", "connectors/**"]

  # ç‰ˆæœ¬ç­–ç•¥
  versioning:
    strategy: "semantic"
    auto_increment: true
    tag_prefix: "v"

  # å‘å¸ƒæ¸ é“
  channels:
    github_releases: true
    pypi: false  # æš‚ä¸å‘å¸ƒåˆ°PyPI
    app_stores: false  # æš‚ä¸å‘å¸ƒåˆ°åº”ç”¨å•†åº—
    custom_registry: true

# æµ‹è¯•é…ç½®
testing:
  # æµ‹è¯•çŸ©é˜µ
  matrix:
    python_versions: ["3.11", "3.12", "3.13"]
    platforms: ["ubuntu-latest", "macos-latest", "windows-latest"]
    flutter_channels: ["stable"]

  # æµ‹è¯•è¶…æ—¶
  timeouts:
    unit_tests: 10  # åˆ†é’Ÿ
    integration_tests: 30  # åˆ†é’Ÿ
    e2e_tests: 45  # åˆ†é’Ÿ

  # æ€§èƒ½åŸºå‡†
  performance_benchmarks:
    ipc_latency_max: 0.010  # 10ms
    startup_time_max: 3.0   # 3 seconds
    memory_usage_max: 500   # MB

# é€šçŸ¥é…ç½®
notifications:
  slack_webhook: ""  # ç•™ç©ºï¼Œä»secretsè¯»å–
  discord_webhook: ""  # ç•™ç©ºï¼Œä»secretsè¯»å–
  email_recipients: []

  # é€šçŸ¥è§¦å‘æ¡ä»¶
  triggers:
    build_failure: true
    release_success: true
    security_alerts: true
    performance_regression: true
