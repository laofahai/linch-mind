# Linch Mind - å‰ªè´´æ¿è¿æ¥å™¨é…ç½®
# é«˜æ€§èƒ½C++å‰ªè´´æ¿ç›‘æ§è¿æ¥å™¨ï¼Œå®æ—¶æ•è·å‰ªè´´æ¿å†…å®¹å˜åŒ–

[metadata]
id = "clipboard"
name = "å‰ªè´´æ¿è¿æ¥å™¨"
version = "0.1.1" 
author = "Linch Mind Team"
description = "é«˜æ€§èƒ½C++å‰ªè´´æ¿ç›‘æ§è¿æ¥å™¨ï¼Œå®æ—¶æ•è·å‰ªè´´æ¿å†…å®¹å¹¶å»ºç«‹æ™ºèƒ½å…³è”"
homepage = "https://github.com/linch-mind/connectors/clipboard"
license = "MIT"
category = "system_integration"
icon = "content_paste"

# JSON Schema å¼•ç”¨
schema = "../../connector.schema.json"

[build]
build_command = "./build.sh"
pre_build = "echo 'Preparing C++ clipboard monitoring build'"
post_build = "echo 'Clipboard connector build completed'"

[capabilities]
hot_reload = true
max_instances = 1  # å‰ªè´´æ¿è¿æ¥å™¨åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹
supports_multiple_instances = false

# æƒé™è¦æ±‚
permissions = [
    "system:clipboard:read",
    "network:daemon-api"
]

# å¹³å°æ”¯æŒ
[platforms.linux]
min_version = "ubuntu-20.04"

[platforms.macos] 
min_version = "10.15"

[platforms.windows]
min_version = "10"

# å…¥å£ç‚¹é…ç½®
[entry.development]
command = "bash"
working_dir = "."
args = [
    "-c",
    """# Smart build and run for clipboard
exe_name='linch-mind-clipboard'
[[ '$OSTYPE' == 'msys' || '$OSTYPE' == 'win32' ]] && exe_name='$exe_name.exe'

# Check if build is needed
if [[ ! -f "bin/release/$exe_name" && ! -f "bin/debug/$exe_name" ]] || [[ src/main.cpp -nt "bin/release/$exe_name" ]] || [[ src/main.cpp -nt "bin/debug/$exe_name" ]]; then
  echo 'ğŸ”¨ Building clipboard connector...'
  ./build.sh > /dev/null 2>&1 || { echo 'Build failed'; exit 1; }
fi

# Run the newest build
if [[ -f "bin/debug/$exe_name" ]]; then
  exec "./bin/debug/$exe_name"
elif [[ -f "bin/release/$exe_name" ]]; then
  exec "./bin/release/$exe_name"
else
  echo 'âŒ No clipboard executable found after build'
  exit 1
fi"""
]

[entry.production]
linux = "bin/release/linch-mind-clipboard"
macos = "bin/release/linch-mind-clipboard"
windows = "bin/release/linch-mind-clipboard.exe"

# é»˜è®¤é…ç½®å€¼ - ç®€å•ç›´æ¥
[config_default_values]
max_content_length = 50000             # æœ€å¤§å†…å®¹é•¿åº¦

# é…ç½®æ¨¡å¼å®šä¹‰ - æç®€é…ç½®
[config_schema]
description = "å‰ªè´´æ¿è¿æ¥å™¨é…ç½®"
title = "å‰ªè´´æ¿è¿æ¥å™¨"
type = "object"

[config_schema.properties.max_content_length]
title = "æœ€å¤§å†…å®¹é•¿åº¦"
description = "è¶…è¿‡æ­¤é•¿åº¦çš„å†…å®¹å°†è¢«æˆªæ–­"
type = "integer"
minimum = 1000
maximum = 1000000
default = 50000

config_schema.required = ["max_content_length"]