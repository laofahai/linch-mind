# Linch Mind Flutteræ¶æ„è®¾è®¡

**ç‰ˆæœ¬**: V1.0  
**åˆ›å»ºæ—¶é—´**: 2025-08-03  
**çŠ¶æ€**: å½“å‰å®ç°æ¶æ„  
**ç»´æŠ¤è€…**: Linch MindæŠ€æœ¯å›¢é˜Ÿ

## æ¦‚è¿°

Linch Mind Flutteråº”ç”¨é‡‡ç”¨ç°ä»£åŒ–çš„è·¨å¹³å°æ¶æ„è®¾è®¡ï¼ŒåŸºäºRiverpodçŠ¶æ€ç®¡ç†ã€åˆ†å±‚æ¶æ„åŸåˆ™å’Œå“åº”å¼ç¼–ç¨‹æ¨¡å¼ï¼Œä¸ºç”¨æˆ·æä¾›ä¸€è‡´çš„è·¨å¹³å°ä½“éªŒã€‚

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„è®¾è®¡

### åˆ†å±‚æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   UI Layer                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Screens + Widgets + Navigation             â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ HomeScreen (æ™ºèƒ½æ¨èä¸»ç•Œé¢)             â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ GraphScreen (çŸ¥è¯†å›¾è°±å¯è§†åŒ–)           â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ DataScreen (æ•°æ®ç®¡ç†ç•Œé¢)              â”‚ â”‚
â”‚  â”‚  â””â”€â”€ ConnectorManagementScreen             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†• Widget State
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              State Management Layer             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Riverpod Providers + StateNotifiers        â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ AppProviders (å…¨å±€çŠ¶æ€ç®¡ç†)            â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ DataProviders (æ•°æ®çŠ¶æ€)               â”‚ â”‚
â”‚  â”‚  â””â”€â”€ UIStateProviders (ç•Œé¢çŠ¶æ€)           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†• Data Flow
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Service Layer                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  API Clients + Business Logic              â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ IPCClient (Daemon IPCå®¢æˆ·ç«¯)          â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ ConnectorLifecycleApiClient          â”‚ â”‚
â”‚  â”‚  â””â”€â”€ LocalStorageService                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†• IPC/SQLite
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Data Layer                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Data Models + Repositories                â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ IPC Models (IPCæ•°æ®æ¨¡å‹)               â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Local Models (æœ¬åœ°æ•°æ®æ¨¡å‹)            â”‚ â”‚
â”‚  â”‚  â””â”€â”€ Data Transfer Objects                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“± UIå±‚æ¶æ„è®¾è®¡

### Screenç»„ç»‡ç»“æ„

```dart
// ä¸»è¦ç•Œé¢æ¨¡å—
lib/screens/
â”œâ”€â”€ home_screen.dart                 // ä¸»ç•Œé¢ - æ™ºèƒ½æ¨èå±•ç¤º
â”œâ”€â”€ graph_screen.dart                // çŸ¥è¯†å›¾è°±å¯è§†åŒ–ç•Œé¢  
â”œâ”€â”€ data_screen.dart                 // æ•°æ®ç®¡ç†ç•Œé¢
â””â”€â”€ connector_management_screen.dart // è¿æ¥å™¨ç®¡ç†ç•Œé¢

// é€šç”¨UIç»„ä»¶
lib/widgets/
â”œâ”€â”€ recommendation_card.dart         // æ¨èå†…å®¹å¡ç‰‡
â”œâ”€â”€ stats_card.dart                 // ç»Ÿè®¡ä¿¡æ¯å¡ç‰‡
â”œâ”€â”€ status_indicator.dart           // çŠ¶æ€æŒ‡ç¤ºå™¨
â””â”€â”€ responsive_layout.dart          // å“åº”å¼å¸ƒå±€ç»„ä»¶
```

### å“åº”å¼è®¾è®¡ç­–ç•¥

```dart
// è·¨å¹³å°é€‚é…è®¾è®¡
class ResponsiveLayout extends StatelessWidget {
  final Widget mobile;
  final Widget? tablet;
  final Widget desktop;

  @override
  Widget build(BuildContext context) {
    return LayoutBuilder(
      builder: (context, constraints) {
        // ç§»åŠ¨ç«¯: < 600px
        if (constraints.maxWidth < 600) {
          return mobile;
        }
        // å¹³æ¿ç«¯: 600px - 1200px  
        else if (constraints.maxWidth < 1200) {
          return tablet ?? desktop;
        }
        // æ¡Œé¢ç«¯: > 1200px
        else {
          return desktop;
        }
      },
    );
  }
}
```

### Material Design 3 é›†æˆ

```dart
// ä¸»é¢˜é…ç½®
ThemeData buildTheme() {
  return ThemeData(
    useMaterial3: true,
    colorScheme: ColorScheme.fromSeed(
      seedColor: const Color(0xFF6750A4), // Linch Mindå“ç‰Œè‰²
      brightness: Brightness.light,
    ),
    typography: Typography.material2021(),
    elevationOverlay: ElevationOverlay.colorScheme,
  );
}
```

---

## ğŸ”„ çŠ¶æ€ç®¡ç†æ¶æ„ (Riverpod)

### Providerç»„ç»‡ç»“æ„

```dart
// å…¨å±€åº”ç”¨çŠ¶æ€æä¾›è€…
lib/providers/
â””â”€â”€ app_providers.dart              // åº”ç”¨çº§åˆ«çš„çŠ¶æ€ç®¡ç†

// Provideråˆ†ç±»è®¾è®¡
class AppProviders {
  // === æ•°æ®çŠ¶æ€ ===
  static final apiClientProvider = Provider<ApiClient>((ref) {
    return ApiClient(baseUrl: 'http://127.0.0.1:58471');
  });
  
  static final knowledgeDataProvider = 
    StateNotifierProvider<KnowledgeDataNotifier, KnowledgeState>((ref) {
    return KnowledgeDataNotifier(ref.read(apiClientProvider));
  });
  
  // === UIçŠ¶æ€ ===
  static final navigationProvider = 
    StateNotifierProvider<NavigationNotifier, int>((ref) {
    return NavigationNotifier();
  });
  
  static final connectorStatusProvider = 
    StateNotifierProvider<ConnectorStatusNotifier, ConnectorStatusState>((ref) {
    return ConnectorStatusNotifier(ref.read(apiClientProvider));
  });
}
```

### çŠ¶æ€æµè½¬è®¾è®¡

```dart
// æ•°æ®çŠ¶æ€ç®¡ç†ç¤ºä¾‹
class KnowledgeDataNotifier extends StateNotifier<KnowledgeState> {
  final ApiClient _apiClient;
  
  KnowledgeDataNotifier(this._apiClient) : super(KnowledgeState.loading()) {
    _loadInitialData();
  }
  
  Future<void> _loadInitialData() async {
    try {
      // 1. åŠ è½½çŸ¥è¯†å›¾è°±æ•°æ®
      final graphData = await _apiClient.getGraphData();
      
      // 2. åŠ è½½æ¨èå†…å®¹
      final recommendations = await _apiClient.getRecommendations();
      
      // 3. æ›´æ–°çŠ¶æ€
      state = KnowledgeState.loaded(
        graphData: graphData,
        recommendations: recommendations,
      );
    } catch (e) {
      state = KnowledgeState.error(e.toString());
    }
  }
  
  Future<void> refreshData() async {
    state = state.copyWith(isRefreshing: true);
    await _loadInitialData();
  }
}
```

### çŠ¶æ€æŒä¹…åŒ–ç­–ç•¥

```dart
// æœ¬åœ°çŠ¶æ€æŒä¹…åŒ–
class LocalStorageService {
  static const String _userPrefsKey = 'user_preferences';
  static const String _cacheKey = 'app_cache';
  
  static Future<void> saveUserPreferences(UserPreferences prefs) async {
    final sharedPrefs = await SharedPreferences.getInstance();
    final json = jsonEncode(prefs.toJson());
    await sharedPrefs.setString(_userPrefsKey, json);
  }
  
  static Future<UserPreferences?> loadUserPreferences() async {
    final sharedPrefs = await SharedPreferences.getInstance();
    final json = sharedPrefs.getString(_userPrefsKey);
    if (json != null) {
      return UserPreferences.fromJson(jsonDecode(json));
    }
    return null;
  }
}
```

---

## ğŸ”„ é€šä¿¡å±‚æ¶æ„è®¾è®¡

### IPCå®¢æˆ·ç«¯é…ç½®

```dart
// IPCå®¢æˆ·ç«¯é…ç½®
class IPCClient {
  late final String _socketPath;
  final String baseUrl;
  
  ApiClient({required this.baseUrl}) {
    _dio = Dio(BaseOptions(
      baseUrl: baseUrl,
      connectTimeout: const Duration(seconds: 10),
      receiveTimeout: const Duration(seconds: 30),
      headers: {
        'Content-Type': 'application/json',
        'Accept': 'application/json',
      },
    ));
    
    // è¯·æ±‚/å“åº”æ‹¦æˆªå™¨
    _dio.interceptors.addAll([
      LogInterceptor(
        requestBody: true,
        responseBody: true,
        logPrint: (obj) => developer.log(obj.toString(), name: 'IPC'),
      ),
      ErrorInterceptor(),
      RetryInterceptor(),
    ]);
  }
}
```

### IPCæ¥å£è®¾è®¡æ¨¡å¼

```dart
// IPCé€šä¿¡å®¢æˆ·ç«¯
class IPCClient {
  // === çŸ¥è¯†å›¾è°±ç›¸å…³ ===
  Future<GraphDataResponse> getGraphData() async {
    final response = await _dio.get('/api/v1/graph/data');
    return GraphDataResponse.fromJson(response.data);
  }
  
  Future<List<Recommendation>> getRecommendations() async {
    final response = await _dio.get('/api/v1/recommendations');
    return (response.data['recommendations'] as List)
        .map((json) => Recommendation.fromJson(json))
        .toList();
  }
  
  // === è¿æ¥å™¨ç®¡ç† ===
  Future<List<ConnectorInfo>> getConnectors() async {
    final response = await _dio.get('/api/v1/connectors');
    return (response.data['connectors'] as List)
        .map((json) => ConnectorInfo.fromJson(json))
        .toList();
  }
  
  Future<void> startConnector(String connectorName) async {
    await _dio.post('/api/v1/connectors/$connectorName/start');
  }
  
  Future<void> stopConnector(String connectorName) async {
    await _dio.post('/api/v1/connectors/$connectorName/stop');
  }
}
```

### é”™è¯¯å¤„ç†æœºåˆ¶

```dart
// å…¨å±€é”™è¯¯å¤„ç†æ‹¦æˆªå™¨
class ErrorInterceptor extends Interceptor {
  @override
  void onError(DioException err, ErrorInterceptorHandler handler) {
    final errorMessage = _parseErrorMessage(err);
    
    // è®°å½•é”™è¯¯æ—¥å¿—
    developer.log(
      'IPC Error: ${method}',
      name: 'IPC_ERROR',
      error: errorMessage,
    );
    
    // æ ¹æ®é”™è¯¯ç±»å‹è¿›è¡Œä¸åŒå¤„ç†
    switch (err.type) {
      case DioExceptionType.connectionTimeout:
      case DioExceptionType.receiveTimeout:
        handler.reject(DioException(
          requestOptions: err.requestOptions,
          error: 'ç½‘ç»œè¿æ¥è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œçŠ¶æ€',
        ));
        break;
      case DioExceptionType.connectionError:
        handler.reject(DioException(
          requestOptions: err.requestOptions,
          error: 'æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œè¯·ç¡®ä¿Daemonæ­£åœ¨è¿è¡Œ',
        ));
        break;
      default:
        handler.next(err);
    }
  }
  
  String _parseErrorMessage(DioException err) {
    if (err.response?.data is Map<String, dynamic>) {
      return err.response?.data['message'] ?? err.message ?? 'æœªçŸ¥é”™è¯¯';
    }
    return err.message ?? 'ç½‘ç»œè¯·æ±‚å¤±è´¥';
  }
}
```

---

## ğŸ’¾ æ•°æ®å±‚æ¶æ„è®¾è®¡

### æ•°æ®æ¨¡å‹ç»„ç»‡

```dart
// IPCæ•°æ®æ¨¡å‹ (ä¸Daemoné€šä¿¡)
lib/models/
â”œâ”€â”€ ipc_protocol.dart               // IPCåè®®æ¨¡å‹
â”œâ”€â”€ ipc_protocol.freezed.dart       // Freezedç”Ÿæˆçš„ä¸å¯å˜ç±»
â”œâ”€â”€ ipc_protocol.g.dart             // JSONåºåˆ—åŒ–ä»£ç 
â”œâ”€â”€ connector_lifecycle_models.dart  // è¿æ¥å™¨ç”Ÿå‘½å‘¨æœŸæ¨¡å‹
â”œâ”€â”€ connector_lifecycle_models.freezed.dart
â””â”€â”€ connector_lifecycle_models.g.dart
```

### Freezedæ•°æ®ç±»è®¾è®¡

```dart
// ä½¿ç”¨Freezedåˆ›å»ºä¸å¯å˜æ•°æ®ç±»
@freezed
class GraphDataResponse with _$GraphDataResponse {
  const factory GraphDataResponse({
    required List<NodeEntity> nodes,
    required List<RelationshipEntity> relationships,
    required GraphStatistics statistics,
  }) = _GraphDataResponse;

  factory GraphDataResponse.fromJson(Map<String, dynamic> json) =>
      _$GraphDataResponseFromJson(json);
}

@freezed
class NodeEntity with _$NodeEntity {
  const factory NodeEntity({
    required String id,
    required String label,
    required String type,
    required Map<String, dynamic> properties,
    @Default([]) List<String> tags,
  }) = _NodeEntity;

  factory NodeEntity.fromJson(Map<String, dynamic> json) =>
      _$NodeEntityFromJson(json);
}

@freezed
class Recommendation with _$Recommendation {
  const factory Recommendation({
    required String id,
    required String title,
    required String description,
    required double score,
    required String type,
    required DateTime timestamp,
    @Default({}) Map<String, dynamic> metadata,
  }) = _Recommendation;

  factory Recommendation.fromJson(Map<String, dynamic> json) =>
      _$RecommendationFromJson(json);
}
```

### æ•°æ®ä»“åº“æ¨¡å¼

```dart
// æ•°æ®ä»“åº“æŠ½è±¡å±‚
abstract class DataRepository {
  Future<List<T>> getAll<T>();
  Future<T?> getById<T>(String id);
  Future<void> save<T>(T item);
  Future<void> delete<T>(String id);
}

// ç½‘ç»œæ•°æ®ä»“åº“å®ç°
class ApiDataRepository implements DataRepository {
  final ApiClient _apiClient;
  
  ApiDataRepository(this._apiClient);
  
  @override
  Future<List<Recommendation>> getAll<Recommendation>() async {
    return await _apiClient.getRecommendations();
  }
  
  // å…¶ä»–å®ç°...
}

// æœ¬åœ°ç¼“å­˜æ•°æ®ä»“åº“
class LocalDataRepository implements DataRepository {
  final Database _database;
  
  LocalDataRepository(this._database);
  
  @override
  Future<List<T>> getAll<T>() async {
    // SQLiteæŸ¥è¯¢å®ç°
  }
  
  // å…¶ä»–å®ç°...
}
```

---

## ğŸ¨ UI/UXè®¾è®¡æ¨¡å¼

### ç»„ä»¶åŒ–è®¾è®¡ç­–ç•¥

```dart
// å¯å¤ç”¨çš„æ¨èå¡ç‰‡ç»„ä»¶
class RecommendationCard extends StatelessWidget {
  final Recommendation recommendation;
  final VoidCallback? onTap;
  
  const RecommendationCard({
    Key? key,
    required this.recommendation,
    this.onTap,
  }) : super(key: key);
  
  @override
  Widget build(BuildContext context) {
    return Card(
      elevation: 2,
      margin: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),
      child: InkWell(
        onTap: onTap,
        borderRadius: BorderRadius.circular(12),
        child: Padding(
          padding: const EdgeInsets.all(16),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              // æ ‡é¢˜å’Œè¯„åˆ†
              Row(
                mainAxisAlignment: MainAxisAlignment.spaceBetween,
                children: [
                  Expanded(
                    child: Text(
                      recommendation.title,
                      style: Theme.of(context).textTheme.titleMedium,
                      maxLines: 2,
                      overflow: TextOverflow.ellipsis,
                    ),
                  ),
                  _buildScoreChip(recommendation.score),
                ],
              ),
              const SizedBox(height: 8),
              
              // æè¿°
              Text(
                recommendation.description,
                style: Theme.of(context).textTheme.bodyMedium,
                maxLines: 3,
                overflow: TextOverflow.ellipsis,
              ),
              const SizedBox(height: 12),
              
              // å…ƒæ•°æ®å’Œæ—¶é—´
              Row(
                mainAxisAlignment: MainAxisAlignment.spaceBetween,
                children: [
                  _buildTypeChip(recommendation.type),
                  Text(
                    _formatTimestamp(recommendation.timestamp),
                    style: Theme.of(context).textTheme.captionMedium,
                  ),
                ],
              ),
            ],
          ),
        ),
      ),
    );
  }
}
```

### çŠ¶æ€æŒ‡ç¤ºå™¨è®¾è®¡

```dart
// ç³»ç»ŸçŠ¶æ€æŒ‡ç¤ºå™¨
class StatusIndicator extends StatelessWidget {
  final ConnectorStatus status;
  final String name;
  
  @override
  Widget build(BuildContext context) {
    return Container(
      padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 6),
      decoration: BoxDecoration(
        color: _getStatusColor(status).withOpacity(0.1),
        borderRadius: BorderRadius.circular(20),
        border: Border.all(
          color: _getStatusColor(status),
          width: 1,
        ),
      ),
      child: Row(
        mainAxisSize: MainAxisSize.min,
        children: [
          Icon(
            _getStatusIcon(status),
            size: 16,
            color: _getStatusColor(status),
          ),
          const SizedBox(width: 6),
          Text(
            name,
            style: TextStyle(
              color: _getStatusColor(status),
              fontWeight: FontWeight.w500,
              fontSize: 12,
            ),
          ),
        ],
      ),
    );
  }
  
  Color _getStatusColor(ConnectorStatus status) {
    switch (status) {
      case ConnectorStatus.running:
        return Colors.green;
      case ConnectorStatus.stopped:
        return Colors.grey;
      case ConnectorStatus.error:
        return Colors.red;
      case ConnectorStatus.starting:
        return Colors.orange;
    }
  }
}
```

---

## ğŸš€ å¯¼èˆªå’Œè·¯ç”±æ¶æ„

### GoRouteré…ç½®

```dart
// åº”ç”¨è·¯ç”±é…ç½®
final appRouter = GoRouter(
  initialLocation: '/',
  routes: [
    GoRoute(
      path: '/',
      name: 'home',
      builder: (context, state) => const HomeScreen(),
    ),
    GoRoute(
      path: '/graph',
      name: 'graph',
      builder: (context, state) => const GraphScreen(),
    ),
    GoRoute(
      path: '/data',
      name: 'data',
      builder: (context, state) => const DataScreen(),
    ),
    GoRoute(
      path: '/connectors',
      name: 'connectors',
      builder: (context, state) => const ConnectorManagementScreen(),
    ),
  ],
  errorBuilder: (context, state) => ErrorScreen(error: state.error),
);

// åœ¨ä¸»åº”ç”¨ä¸­ä½¿ç”¨
class LinchMindApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp.router(
      title: 'Linch Mind',
      theme: buildTheme(),
      routerConfig: appRouter,
    );
  }
}
```

### åº•éƒ¨å¯¼èˆªé›†æˆ

```dart
// ä¸»ç•Œé¢å¯¼èˆªæ¶æ„
class MainNavigationScreen extends ConsumerWidget {
  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final currentIndex = ref.watch(navigationProvider);
    
    return Scaffold(
      body: IndexedStack(
        index: currentIndex,
        children: const [
          HomeScreen(),
          GraphScreen(),
          DataScreen(),
          ConnectorManagementScreen(),
        ],
      ),
      bottomNavigationBar: NavigationBar(
        selectedIndex: currentIndex,
        onDestinationSelected: (index) {
          ref.read(navigationProvider.notifier).setIndex(index);
        },
        destinations: const [
          NavigationDestination(
            icon: Icon(Icons.home_outlined),
            selectedIcon: Icon(Icons.home),
            label: 'é¦–é¡µ',
          ),
          NavigationDestination(
            icon: Icon(Icons.account_tree_outlined),
            selectedIcon: Icon(Icons.account_tree),
            label: 'å›¾è°±',
          ),
          NavigationDestination(
            icon: Icon(Icons.storage_outlined),
            selectedIcon: Icon(Icons.storage),
            label: 'æ•°æ®',
          ),
          NavigationDestination(
            icon: Icon(Icons.extension_outlined),
            selectedIcon: Icon(Icons.extension),
            label: 'è¿æ¥å™¨',
          ),
        ],
      ),
    );
  }
}
```

---

## ğŸ”§ æ„å»ºå’Œéƒ¨ç½²é…ç½®

### å¹³å°ç‰¹å®šé…ç½®

```yaml
# pubspec.yaml - è·¨å¹³å°ä¾èµ–ç®¡ç†
dependencies:
  flutter:
    sdk: flutter
  
  # çŠ¶æ€ç®¡ç†
  flutter_riverpod: ^2.4.0
  riverpod_annotation: ^2.3.0
  
  # ç½‘ç»œå’Œæ•°æ®
  dio: ^5.3.0
  sqflite: ^2.3.0
  shared_preferences: ^2.2.0
  
  # UIå’Œå¯¼èˆª
  go_router: ^12.0.0
  flutter_svg: ^2.0.0
  
  # å·¥å…·
  freezed_annotation: ^2.4.4
  json_annotation: ^4.9.0

dev_dependencies:
  # ä»£ç ç”Ÿæˆ
  build_runner: ^2.4.0
  freezed: ^2.5.8
  json_serializable: ^6.9.5
  riverpod_generator: ^2.3.0
```

### ä»£ç ç”Ÿæˆè„šæœ¬

```bash
# å¼€å‘å·¥å…·è„šæœ¬
#!/bin/bash

# ä»£ç ç”Ÿæˆ
flutter packages pub run build_runner build --delete-conflicting-outputs

# ä»£ç æ ¼å¼åŒ–
dart format lib/ test/

# é™æ€åˆ†æ
flutter analyze

# æµ‹è¯•
flutter test

echo "Flutteré¡¹ç›®æ„å»ºå®Œæˆ!"
```

### å¹³å°æ„å»ºé…ç½®

```bash
# è·¨å¹³å°æ„å»ºè„šæœ¬
#!/bin/bash

echo "å¼€å§‹è·¨å¹³å°æ„å»º..."

# macOSæ¡Œé¢åº”ç”¨
flutter build macos --release

# Windowsæ¡Œé¢åº”ç”¨ (åœ¨Windowsç¯å¢ƒä¸­)
# flutter build windows --release

# Linuxæ¡Œé¢åº”ç”¨ (åœ¨Linuxç¯å¢ƒä¸­)  
# flutter build linux --release

# Androidåº”ç”¨
flutter build apk --release

# iOSåº”ç”¨ (åœ¨macOSç¯å¢ƒä¸­)
# flutter build ios --release

echo "æ„å»ºå®Œæˆ!"
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### å†…å­˜ç®¡ç†

```dart
// å›¾ç‰‡ç¼“å­˜ä¼˜åŒ–
class OptimizedImageWidget extends StatelessWidget {
  final String imageUrl;
  
  @override
  Widget build(BuildContext context) {
    return Image.network(
      imageUrl,
      cacheWidth: 300, // é™åˆ¶ç¼“å­˜å›¾ç‰‡å®½åº¦
      cacheHeight: 200, // é™åˆ¶ç¼“å­˜å›¾ç‰‡é«˜åº¦
      loadingBuilder: (context, child, loadingProgress) {
        if (loadingProgress == null) return child;
        return const CircularProgressIndicator();
      },
      errorBuilder: (context, error, stackTrace) {
        return const Icon(Icons.error);
      },
    );
  }
}
```

### åˆ—è¡¨æ€§èƒ½ä¼˜åŒ–

```dart
// å¤§æ•°æ®é‡åˆ—è¡¨ä¼˜åŒ–
class OptimizedRecommendationList extends StatelessWidget {
  final List<Recommendation> recommendations;
  
  @override
  Widget build(BuildContext context) {
    return ListView.builder(
      itemCount: recommendations.length,
      itemExtent: 120, // å›ºå®šItemé«˜åº¦ï¼Œæå‡æ»šåŠ¨æ€§èƒ½
      cacheExtent: 500, // é¢„ç¼“å­˜èŒƒå›´
      itemBuilder: (context, index) {
        return RecommendationCard(
          key: ValueKey(recommendations[index].id), // ç¨³å®šçš„key
          recommendation: recommendations[index],
        );
      },
    );
  }
}
```

### çŠ¶æ€ä¼˜åŒ–

```dart
// æ™ºèƒ½çŠ¶æ€æ›´æ–°
class SmartStateNotifier extends StateNotifier<AppState> {
  SmartStateNotifier() : super(AppState.initial());
  
  void updateData(List<Recommendation> newRecommendations) {
    // åªåœ¨æ•°æ®çœŸæ­£å˜åŒ–æ—¶æ›´æ–°çŠ¶æ€
    if (!listEquals(state.recommendations, newRecommendations)) {
      state = state.copyWith(recommendations: newRecommendations);
    }
  }
}
```

---

## ğŸ”® æœªæ¥æ¶æ„æ¼”è¿›è®¡åˆ’

### æ¨¡å—åŒ–æ‰©å±•
```dart
// æ’ä»¶åŒ–UIæ¨¡å—è®¾è®¡
abstract class UIModule {
  String get name;
  Widget buildScreen(BuildContext context);
  List<NavigationDestination> get navigationItems;
}

// AIå¯¹è¯æ¨¡å— (è®¡åˆ’ä¸­)
class AIChatModule implements UIModule {
  @override
  String get name => 'AI Chat';
  
  @override
  Widget buildScreen(BuildContext context) {
    return const AIChatScreen();
  }
}
```

### ç¦»çº¿ä¼˜å…ˆç­–ç•¥
```dart
// ç¦»çº¿æ•°æ®åŒæ­¥
class OfflineFirstRepository {
  Future<List<T>> getData<T>() async {
    // 1. é¦–å…ˆå°è¯•ä»æœ¬åœ°è·å–
    final localData = await _localRepo.getAll<T>();
    
    // 2. åå°åŒæ­¥è¿œç¨‹æ•°æ®
    _syncWithRemote<T>();
    
    return localData;
  }
}
```

---

## ğŸ“‹ å¼€å‘æœ€ä½³å®è·µ

### ä»£ç ç»„ç»‡åŸåˆ™
1. **æŒ‰åŠŸèƒ½åˆ†å±‚**: UIã€çŠ¶æ€ã€æœåŠ¡ã€æ•°æ®åˆ†å±‚æ¸…æ™°
2. **Providerä½œç”¨åŸŸ**: å…¨å±€ã€é¡µé¢ã€ç»„ä»¶ä¸‰çº§Providerç®¡ç†
3. **ä¸å¯å˜æ•°æ®**: å…¨é¢ä½¿ç”¨Freezedç¡®ä¿æ•°æ®ä¸å¯å˜æ€§
4. **ç±»å‹å®‰å…¨**: åˆ©ç”¨Dartå¼ºç±»å‹ç³»ç»Ÿé¿å…è¿è¡Œæ—¶é”™è¯¯

### æµ‹è¯•ç­–ç•¥
```dart
// Widgetæµ‹è¯•ç¤ºä¾‹
void main() {
  group('RecommendationCard Widget Tests', () {
    testWidgets('displays recommendation data correctly', (tester) async {
      final recommendation = Recommendation(
        id: 'test-id',
        title: 'Test Recommendation',
        description: 'Test Description',
        score: 0.85,
        type: 'knowledge',
        timestamp: DateTime.now(),
      );
      
      await tester.pumpWidget(
        MaterialApp(
          home: RecommendationCard(recommendation: recommendation),
        ),
      );
      
      expect(find.text('Test Recommendation'), findsOneWidget);
      expect(find.text('Test Description'), findsOneWidget);
    });
  });
}
```

---

## ğŸ“š æŠ€æœ¯æ ˆæ€»ç»“

### æ ¸å¿ƒä¾èµ–
- **Flutter**: 3.24+ (è·¨å¹³å°UIæ¡†æ¶)
- **Riverpod**: 2.4+ (å“åº”å¼çŠ¶æ€ç®¡ç†)
- **dart:io**: Socket (IPCé€šä¿¡)
- **Freezed**: 2.5+ (ä¸å¯å˜æ•°æ®ç±»)
- **GoRouter**: 12.0+ (å£°æ˜å¼è·¯ç”±)

### å¼€å‘å·¥å…·
- **build_runner**: ä»£ç ç”Ÿæˆ
- **flutter_lints**: ä»£ç è´¨é‡
- **flutter_test**: å•å…ƒå’ŒWidgetæµ‹è¯•

**æ–‡æ¡£ç‰ˆæœ¬**: V1.0  
**æ¶æ„çŠ¶æ€**: ç”Ÿäº§å°±ç»ª  
**æœ€åæ›´æ–°**: 2025-08-03  

Linch Mind Flutteræ¶æ„ä¸ºè·¨å¹³å°ä¸ªäººAIåŠ©æ‰‹åº”ç”¨æä¾›äº†åšå®çš„æŠ€æœ¯åŸºç¡€ï¼Œæ”¯æŒå¿«é€Ÿè¿­ä»£å¼€å‘å’Œé•¿æœŸç»´æŠ¤æ¼”è¿›ã€‚ğŸš€